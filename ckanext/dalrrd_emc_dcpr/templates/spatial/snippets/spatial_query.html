{% asset 'ckanext-dalrrdemcdcpr/dataset-spatial-extent-map-js' %}
<section id="dataset-map" class="module module-narrow module-shallow">
    <h2 class="module-heading">
        <i class="icon-medium icon-globe"></i>
        {{ _('Filter by location') }}
        <a href="{{ h.remove_url_param(['ext_bbox','ext_prev_extent', 'ext_location']) }}" class="action">{{ _('Clear') }}</a>
    </h2>
    {% set map_config = h.get_common_map_config() %}
    <div class="dataset-map" data-module="spatial-query" data-default_extent="{{ default_extent }}" data-module-map_config="{{ h.dump_json(map_config) }}">
        <div id="dataset-map-container" data-module="spatial_search"></div>
    </div>
    <div id="dataset-map-attribution">
        {% snippet "spatial/snippets/map_attribution.html", map_config=map_config %}
    </div>
</section>

{% set type = 'asset' if h.ckan_version().split('.')[1] | int >= 9 else 'resource' %}
{% include 'spatial/snippets/spatial_query_' ~ type ~ '.html' %}
